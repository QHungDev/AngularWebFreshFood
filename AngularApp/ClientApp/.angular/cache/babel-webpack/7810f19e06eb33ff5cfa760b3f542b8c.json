{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\AdminSiteCore-Standard\\\\AdminSiteCore-Standard\\\\AdminSiteCore\\\\AngularApp\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { forkJoin } from 'rxjs';\nlet ProductDetailComponent = class ProductDetailComponent {\n  constructor(productService, router, formBuilder, http, activeRoute) {\n    this.productService = productService;\n    this.router = router;\n    this.formBuilder = formBuilder;\n    this.http = http;\n    this.activeRoute = activeRoute;\n    this.editorConfig = {\n      base_url: '/tinymce',\n      suffix: '.min',\n      plugins: 'lists link image table wordcount'\n    };\n    this.productCategories = [];\n    this.postProductRequest = {\n      ProductID: \"\",\n      Thumb: \"\",\n      Title: \"\",\n      Avatar: \"\",\n      Description: \"\",\n      Content: \"\",\n      Specification: \"\",\n      Warranty: \"\",\n      Accessories: \"\",\n      Price: \"\",\n      OldPrice: \"\",\n      Quantity: \"\",\n      ImageList: \"\",\n      Position: \"\",\n      CreateBy: \"\",\n      CreateTime: new Date(),\n      Status: true,\n      ProductCategoryID: \"\"\n    };\n    this.productID = '';\n    this.form = this.formBuilder.group({\n      productCategoryID: [''],\n      username: [''],\n      title: [''],\n      thumb: [''],\n      avatar: [''],\n      description: [''],\n      content: [''],\n      specification: [''],\n      warranty: [''],\n      accessories: [''],\n      price: [''],\n      oldPrice: [''],\n      quantity: [''],\n      createTime: [''],\n      createBy: [''],\n      imageList: [''],\n      position: [''],\n      status: [true]\n    });\n  }\n\n  ngOnInit() {\n    const productsObservable = this.productService.getProductCategories();\n    productsObservable.subscribe(productsData => {\n      this.productCategories = productsData;\n      this.activeRoute.queryParams.subscribe(params => {\n        this.productID = params.productID;\n\n        if (this.productID && this.productID !== \"\") {\n          const productsObservable = this.productService.getProduct(this.productID);\n          productsObservable.subscribe(productsData => {\n            this.postProductRequest = productsData;\n          });\n        }\n      });\n    });\n  }\n\n  backToList(e) {\n    e.preventDefault();\n    this.router.navigate(['/product']);\n  }\n\n  saveProduct(e) {\n    e.preventDefault();\n    this.router.navigate(['/product']);\n  }\n\n  onFileSelected(event) {\n    this.selectedFile = event.target.files[0];\n  }\n\n  showImg(imgName) {\n    //var str = \"FileUploads/Product/Avatar/f0f34b03-9f95-4efe-946a-39eb0d467af2.jpg\"\n    if (imgName !== undefined) {\n      var name = imgName.split('/')[4];\n      var imgUrl = 'https://localhost:7265/api/product/' + name;\n      return imgUrl;\n    }\n\n    return;\n  }\n\n  submitForm() {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;\n\n    debugger;\n    var productCategoryID = (_a = this.form.get('productCategoryID')) === null || _a === void 0 ? void 0 : _a.value;\n    var title = (_b = this.form.get('title')) === null || _b === void 0 ? void 0 : _b.value;\n    var avatar = (_c = this.form.get('avatar')) === null || _c === void 0 ? void 0 : _c.value;\n    var productID = (_d = this.form.get('productID')) === null || _d === void 0 ? void 0 : _d.value;\n    var thumb = (_e = this.form.get('thumb')) === null || _e === void 0 ? void 0 : _e.value;\n    var description = (_f = this.form.get('description')) === null || _f === void 0 ? void 0 : _f.value;\n    var specification = (_g = this.form.get('specification')) === null || _g === void 0 ? void 0 : _g.value;\n    var content = (_h = this.form.get('content')) === null || _h === void 0 ? void 0 : _h.value;\n    var warranty = (_j = this.form.get('warranty')) === null || _j === void 0 ? void 0 : _j.value;\n    var price = (_k = this.form.get('price')) === null || _k === void 0 ? void 0 : _k.value;\n    var oldPrice = (_l = this.form.get('oldPrice')) === null || _l === void 0 ? void 0 : _l.value;\n    var quantity = (_m = this.form.get('quantity')) === null || _m === void 0 ? void 0 : _m.value;\n    var imageList = (_o = this.form.get('imageList')) === null || _o === void 0 ? void 0 : _o.value;\n    var position = (_p = this.form.get('position')) === null || _p === void 0 ? void 0 : _p.value;\n    var createTime = (_q = this.form.get('createTime')) === null || _q === void 0 ? void 0 : _q.value;\n    var createBy = (_r = this.form.get('createBy')) === null || _r === void 0 ? void 0 : _r.value;\n    var status = (_s = this.form.get('status')) === null || _s === void 0 ? void 0 : _s.value;\n    this.postProductRequest.Title = title;\n    this.postProductRequest.ProductID = productID;\n    this.postProductRequest.Thumb = thumb;\n    this.postProductRequest.Description = description;\n    this.postProductRequest.Avatar = avatar;\n    this.postProductRequest.Specification = specification;\n    this.postProductRequest.Content = content;\n    this.postProductRequest.Warranty = warranty;\n    this.postProductRequest.Price = price;\n    this.postProductRequest.OldPrice = oldPrice;\n    this.postProductRequest.Quantity = quantity;\n    this.postProductRequest.ImageList = imageList;\n    this.postProductRequest.Position = position;\n    this.postProductRequest.CreateTime = new Date();\n    this.postProductRequest.CreateBy = window.localStorage.getItem('Username');\n    this.postProductRequest.Status = status;\n    this.postProductRequest.ProductCategoryID = productCategoryID;\n    let imageFormData = new FormData();\n\n    if (this.uploadedImage !== undefined) {\n      imageFormData.append('this.postProductRequest.Avatar', this.uploadedImage, (_t = this.uploadedImage) === null || _t === void 0 ? void 0 : _t.name);\n    }\n\n    console.log(\"formdata\", imageFormData);\n    const updateProductforkJoin = this.productService.updateProduct(this.productID, this.postProductRequest);\n    const upLoadImageforkJoin = this.productService.uploadImagev2(this.productID, imageFormData);\n\n    if (this.productID && this.productID !== \"\") {\n      //Update\n      if (this.postProductRequest.ProductCategoryID && this.postProductRequest.ProductCategoryID !== \"\" && this.postProductRequest.ProductCategoryID !== undefined) {\n        forkJoin([updateProductforkJoin, upLoadImageforkJoin]).subscribe({\n          next: data => {\n            this.router.navigate(['/product']);\n          },\n          error: error => {\n            alert(error.Error);\n          }\n        });\n      } else {\n        alert('error');\n      }\n    } else {\n      //Add new\n      if (this.postProductRequest.ProductCategoryID && this.postProductRequest.ProductCategoryID !== \"\" && this.postProductRequest.ProductCategoryID !== undefined) {\n        this.productService.addProduct(this.postProductRequest).subscribe({\n          next: data => {\n            // this.router.navigate(['/product']);\n            this.add();\n          },\n          error: error => {\n            alert(error.Error);\n          }\n        });\n      } else {\n        alert('error');\n      }\n    }\n  }\n\n  add() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // await this.addItem();\n      yield _this.addImg();\n    })();\n  } // addItem() {\n  //   this.productService.addProduct(this.postProductRequest).subscribe({\n  //     next: (data => {\n  //       // this.router.navigate(['/product']);\n  //     }),\n  //     error: ((error: ErrorResponse) => {\n  //       alert(error.Error);\n  //     })\n  //   });\n  // }\n\n\n  addImg() {\n    if (this.selectedFile) {\n      const imageFile = new FormData();\n      imageFile.append('imageFile', this.selectedFile);\n      this.productService.uploadImagev2(this.productID, imageFile).subscribe(response => {\n        console.log('File uploaded successfully'); // Xử lý dữ liệu phản hồi từ API nếu cần\n      }, error => {\n        console.error('Error uploading file:', error); // Xử lý lỗi nếu cần\n      });\n    } else {\n      console.error('No file selected.');\n    }\n  }\n\n};\nProductDetailComponent = __decorate([Component({\n  selector: 'app-product-detail',\n  templateUrl: './product-detail.component.html',\n  styleUrls: ['./product-detail.component.css']\n})], ProductDetailComponent);\nexport { ProductDetailComponent };","map":{"version":3,"sources":["D:/AdminSiteCore-Standard/AdminSiteCore-Standard/AdminSiteCore/AngularApp/ClientApp/src/app/product/product-detail/product-detail.component.ts"],"names":["__decorate","Component","forkJoin","ProductDetailComponent","constructor","productService","router","formBuilder","http","activeRoute","editorConfig","base_url","suffix","plugins","productCategories","postProductRequest","ProductID","Thumb","Title","Avatar","Description","Content","Specification","Warranty","Accessories","Price","OldPrice","Quantity","ImageList","Position","CreateBy","CreateTime","Date","Status","ProductCategoryID","productID","form","group","productCategoryID","username","title","thumb","avatar","description","content","specification","warranty","accessories","price","oldPrice","quantity","createTime","createBy","imageList","position","status","ngOnInit","productsObservable","getProductCategories","subscribe","productsData","queryParams","params","getProduct","backToList","e","preventDefault","navigate","saveProduct","onFileSelected","event","selectedFile","target","files","showImg","imgName","undefined","name","split","imgUrl","submitForm","_a","_b","_c","_d","_e","_f","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","get","value","window","localStorage","getItem","imageFormData","FormData","uploadedImage","append","console","log","updateProductforkJoin","updateProduct","upLoadImageforkJoin","uploadImagev2","next","data","error","alert","Error","addProduct","add","addImg","imageFile","response","selector","templateUrl","styleUrls"],"mappings":";AAAA,SAASA,UAAT,QAA2B,OAA3B;AACA,SAASC,SAAT,QAA0B,eAA1B;AACA,SAASC,QAAT,QAAyB,MAAzB;AACA,IAAIC,sBAAsB,GAAG,MAAMA,sBAAN,CAA6B;AACtDC,EAAAA,WAAW,CAACC,cAAD,EAAiBC,MAAjB,EAAyBC,WAAzB,EAAsCC,IAAtC,EAA4CC,WAA5C,EAAyD;AAChE,SAAKJ,cAAL,GAAsBA,cAAtB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,WAAL,GAAmBA,WAAnB;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACA,SAAKC,WAAL,GAAmBA,WAAnB;AACA,SAAKC,YAAL,GAAoB;AAChBC,MAAAA,QAAQ,EAAE,UADM;AAEhBC,MAAAA,MAAM,EAAE,MAFQ;AAGhBC,MAAAA,OAAO,EAAE;AAHO,KAApB;AAKA,SAAKC,iBAAL,GAAyB,EAAzB;AACA,SAAKC,kBAAL,GAA0B;AACtBC,MAAAA,SAAS,EAAE,EADW;AAEtBC,MAAAA,KAAK,EAAE,EAFe;AAGtBC,MAAAA,KAAK,EAAE,EAHe;AAItBC,MAAAA,MAAM,EAAE,EAJc;AAKtBC,MAAAA,WAAW,EAAE,EALS;AAMtBC,MAAAA,OAAO,EAAE,EANa;AAOtBC,MAAAA,aAAa,EAAE,EAPO;AAQtBC,MAAAA,QAAQ,EAAE,EARY;AAStBC,MAAAA,WAAW,EAAE,EATS;AAUtBC,MAAAA,KAAK,EAAE,EAVe;AAWtBC,MAAAA,QAAQ,EAAE,EAXY;AAYtBC,MAAAA,QAAQ,EAAE,EAZY;AAatBC,MAAAA,SAAS,EAAE,EAbW;AActBC,MAAAA,QAAQ,EAAE,EAdY;AAetBC,MAAAA,QAAQ,EAAE,EAfY;AAgBtBC,MAAAA,UAAU,EAAE,IAAIC,IAAJ,EAhBU;AAiBtBC,MAAAA,MAAM,EAAE,IAjBc;AAkBtBC,MAAAA,iBAAiB,EAAE;AAlBG,KAA1B;AAoBA,SAAKC,SAAL,GAAiB,EAAjB;AACA,SAAKC,IAAL,GAAY,KAAK7B,WAAL,CAAiB8B,KAAjB,CAAuB;AAC/BC,MAAAA,iBAAiB,EAAE,CAAC,EAAD,CADY;AAE/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAFqB;AAG/BC,MAAAA,KAAK,EAAE,CAAC,EAAD,CAHwB;AAI/BC,MAAAA,KAAK,EAAE,CAAC,EAAD,CAJwB;AAK/BC,MAAAA,MAAM,EAAE,CAAC,EAAD,CALuB;AAM/BC,MAAAA,WAAW,EAAE,CAAC,EAAD,CANkB;AAO/BC,MAAAA,OAAO,EAAE,CAAC,EAAD,CAPsB;AAQ/BC,MAAAA,aAAa,EAAE,CAAC,EAAD,CARgB;AAS/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CATqB;AAU/BC,MAAAA,WAAW,EAAE,CAAC,EAAD,CAVkB;AAW/BC,MAAAA,KAAK,EAAE,CAAC,EAAD,CAXwB;AAY/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAZqB;AAa/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAbqB;AAc/BC,MAAAA,UAAU,EAAE,CAAC,EAAD,CAdmB;AAe/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAfqB;AAgB/BC,MAAAA,SAAS,EAAE,CAAC,EAAD,CAhBoB;AAiB/BC,MAAAA,QAAQ,EAAE,CAAC,EAAD,CAjBqB;AAkB/BC,MAAAA,MAAM,EAAE,CAAC,IAAD;AAlBuB,KAAvB,CAAZ;AAoBH;;AACDC,EAAAA,QAAQ,GAAG;AACP,UAAMC,kBAAkB,GAAG,KAAKpD,cAAL,CAAoBqD,oBAApB,EAA3B;AACAD,IAAAA,kBAAkB,CAACE,SAAnB,CAA8BC,YAAD,IAAkB;AAC3C,WAAK9C,iBAAL,GAAyB8C,YAAzB;AACA,WAAKnD,WAAL,CAAiBoD,WAAjB,CAA6BF,SAA7B,CAAuCG,MAAM,IAAI;AAC7C,aAAK3B,SAAL,GAAiB2B,MAAM,CAAC3B,SAAxB;;AACA,YAAI,KAAKA,SAAL,IAAkB,KAAKA,SAAL,KAAmB,EAAzC,EAA6C;AACzC,gBAAMsB,kBAAkB,GAAG,KAAKpD,cAAL,CAAoB0D,UAApB,CAA+B,KAAK5B,SAApC,CAA3B;AACAsB,UAAAA,kBAAkB,CAACE,SAAnB,CAA8BC,YAAD,IAAkB;AAC3C,iBAAK7C,kBAAL,GAA0B6C,YAA1B;AACH,WAFD;AAGH;AACJ,OARD;AASH,KAXD;AAYH;;AACDI,EAAAA,UAAU,CAACC,CAAD,EAAI;AACVA,IAAAA,CAAC,CAACC,cAAF;AACA,SAAK5D,MAAL,CAAY6D,QAAZ,CAAqB,CAAC,UAAD,CAArB;AACH;;AACDC,EAAAA,WAAW,CAACH,CAAD,EAAI;AACXA,IAAAA,CAAC,CAACC,cAAF;AACA,SAAK5D,MAAL,CAAY6D,QAAZ,CAAqB,CAAC,UAAD,CAArB;AACH;;AACDE,EAAAA,cAAc,CAACC,KAAD,EAAQ;AAClB,SAAKC,YAAL,GAAoBD,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAApB;AACH;;AACDC,EAAAA,OAAO,CAACC,OAAD,EAAU;AACb;AACA,QAAIA,OAAO,KAAKC,SAAhB,EAA2B;AACvB,UAAIC,IAAI,GAAGF,OAAO,CAACG,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAX;AACA,UAAIC,MAAM,GAAG,wCAAwCF,IAArD;AACA,aAAOE,MAAP;AACH;;AACD;AACH;;AACDC,EAAAA,UAAU,GAAG;AACT,QAAIC,EAAJ,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4BC,EAA5B,EAAgCC,EAAhC,EAAoCC,EAApC,EAAwCC,EAAxC,EAA4CC,EAA5C,EAAgDC,EAAhD,EAAoDC,EAApD,EAAwDC,EAAxD,EAA4DC,EAA5D,EAAgEC,EAAhE,EAAoEC,EAApE,EAAwEC,EAAxE;;AACA;AACA,QAAI5D,iBAAiB,GAAG,CAAC2C,EAAE,GAAG,KAAK7C,IAAL,CAAU+D,GAAV,CAAc,mBAAd,CAAN,MAA8C,IAA9C,IAAsDlB,EAAE,KAAK,KAAK,CAAlE,GAAsE,KAAK,CAA3E,GAA+EA,EAAE,CAACmB,KAA1G;AACA,QAAI5D,KAAK,GAAG,CAAC0C,EAAE,GAAG,KAAK9C,IAAL,CAAU+D,GAAV,CAAc,OAAd,CAAN,MAAkC,IAAlC,IAA0CjB,EAAE,KAAK,KAAK,CAAtD,GAA0D,KAAK,CAA/D,GAAmEA,EAAE,CAACkB,KAAlF;AACA,QAAI1D,MAAM,GAAG,CAACyC,EAAE,GAAG,KAAK/C,IAAL,CAAU+D,GAAV,CAAc,QAAd,CAAN,MAAmC,IAAnC,IAA2ChB,EAAE,KAAK,KAAK,CAAvD,GAA2D,KAAK,CAAhE,GAAoEA,EAAE,CAACiB,KAApF;AACA,QAAIjE,SAAS,GAAG,CAACiD,EAAE,GAAG,KAAKhD,IAAL,CAAU+D,GAAV,CAAc,WAAd,CAAN,MAAsC,IAAtC,IAA8Cf,EAAE,KAAK,KAAK,CAA1D,GAA8D,KAAK,CAAnE,GAAuEA,EAAE,CAACgB,KAA1F;AACA,QAAI3D,KAAK,GAAG,CAAC4C,EAAE,GAAG,KAAKjD,IAAL,CAAU+D,GAAV,CAAc,OAAd,CAAN,MAAkC,IAAlC,IAA0Cd,EAAE,KAAK,KAAK,CAAtD,GAA0D,KAAK,CAA/D,GAAmEA,EAAE,CAACe,KAAlF;AACA,QAAIzD,WAAW,GAAG,CAAC2C,EAAE,GAAG,KAAKlD,IAAL,CAAU+D,GAAV,CAAc,aAAd,CAAN,MAAwC,IAAxC,IAAgDb,EAAE,KAAK,KAAK,CAA5D,GAAgE,KAAK,CAArE,GAAyEA,EAAE,CAACc,KAA9F;AACA,QAAIvD,aAAa,GAAG,CAAC0C,EAAE,GAAG,KAAKnD,IAAL,CAAU+D,GAAV,CAAc,eAAd,CAAN,MAA0C,IAA1C,IAAkDZ,EAAE,KAAK,KAAK,CAA9D,GAAkE,KAAK,CAAvE,GAA2EA,EAAE,CAACa,KAAlG;AACA,QAAIxD,OAAO,GAAG,CAAC4C,EAAE,GAAG,KAAKpD,IAAL,CAAU+D,GAAV,CAAc,SAAd,CAAN,MAAoC,IAApC,IAA4CX,EAAE,KAAK,KAAK,CAAxD,GAA4D,KAAK,CAAjE,GAAqEA,EAAE,CAACY,KAAtF;AACA,QAAItD,QAAQ,GAAG,CAAC2C,EAAE,GAAG,KAAKrD,IAAL,CAAU+D,GAAV,CAAc,UAAd,CAAN,MAAqC,IAArC,IAA6CV,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAACW,KAAxF;AACA,QAAIpD,KAAK,GAAG,CAAC0C,EAAE,GAAG,KAAKtD,IAAL,CAAU+D,GAAV,CAAc,OAAd,CAAN,MAAkC,IAAlC,IAA0CT,EAAE,KAAK,KAAK,CAAtD,GAA0D,KAAK,CAA/D,GAAmEA,EAAE,CAACU,KAAlF;AACA,QAAInD,QAAQ,GAAG,CAAC0C,EAAE,GAAG,KAAKvD,IAAL,CAAU+D,GAAV,CAAc,UAAd,CAAN,MAAqC,IAArC,IAA6CR,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAACS,KAAxF;AACA,QAAIlD,QAAQ,GAAG,CAAC0C,EAAE,GAAG,KAAKxD,IAAL,CAAU+D,GAAV,CAAc,UAAd,CAAN,MAAqC,IAArC,IAA6CP,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAACQ,KAAxF;AACA,QAAI/C,SAAS,GAAG,CAACwC,EAAE,GAAG,KAAKzD,IAAL,CAAU+D,GAAV,CAAc,WAAd,CAAN,MAAsC,IAAtC,IAA8CN,EAAE,KAAK,KAAK,CAA1D,GAA8D,KAAK,CAAnE,GAAuEA,EAAE,CAACO,KAA1F;AACA,QAAI9C,QAAQ,GAAG,CAACwC,EAAE,GAAG,KAAK1D,IAAL,CAAU+D,GAAV,CAAc,UAAd,CAAN,MAAqC,IAArC,IAA6CL,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAACM,KAAxF;AACA,QAAIjD,UAAU,GAAG,CAAC4C,EAAE,GAAG,KAAK3D,IAAL,CAAU+D,GAAV,CAAc,YAAd,CAAN,MAAuC,IAAvC,IAA+CJ,EAAE,KAAK,KAAK,CAA3D,GAA+D,KAAK,CAApE,GAAwEA,EAAE,CAACK,KAA5F;AACA,QAAIhD,QAAQ,GAAG,CAAC4C,EAAE,GAAG,KAAK5D,IAAL,CAAU+D,GAAV,CAAc,UAAd,CAAN,MAAqC,IAArC,IAA6CH,EAAE,KAAK,KAAK,CAAzD,GAA6D,KAAK,CAAlE,GAAsEA,EAAE,CAACI,KAAxF;AACA,QAAI7C,MAAM,GAAG,CAAC0C,EAAE,GAAG,KAAK7D,IAAL,CAAU+D,GAAV,CAAc,QAAd,CAAN,MAAmC,IAAnC,IAA2CF,EAAE,KAAK,KAAK,CAAvD,GAA2D,KAAK,CAAhE,GAAoEA,EAAE,CAACG,KAApF;AACA,SAAKrF,kBAAL,CAAwBG,KAAxB,GAAgCsB,KAAhC;AACA,SAAKzB,kBAAL,CAAwBC,SAAxB,GAAoCmB,SAApC;AACA,SAAKpB,kBAAL,CAAwBE,KAAxB,GAAgCwB,KAAhC;AACA,SAAK1B,kBAAL,CAAwBK,WAAxB,GAAsCuB,WAAtC;AACA,SAAK5B,kBAAL,CAAwBI,MAAxB,GAAiCuB,MAAjC;AACA,SAAK3B,kBAAL,CAAwBO,aAAxB,GAAwCuB,aAAxC;AACA,SAAK9B,kBAAL,CAAwBM,OAAxB,GAAkCuB,OAAlC;AACA,SAAK7B,kBAAL,CAAwBQ,QAAxB,GAAmCuB,QAAnC;AACA,SAAK/B,kBAAL,CAAwBU,KAAxB,GAAgCuB,KAAhC;AACA,SAAKjC,kBAAL,CAAwBW,QAAxB,GAAmCuB,QAAnC;AACA,SAAKlC,kBAAL,CAAwBY,QAAxB,GAAmCuB,QAAnC;AACA,SAAKnC,kBAAL,CAAwBa,SAAxB,GAAoCyB,SAApC;AACA,SAAKtC,kBAAL,CAAwBc,QAAxB,GAAmCyB,QAAnC;AACA,SAAKvC,kBAAL,CAAwBgB,UAAxB,GAAqC,IAAIC,IAAJ,EAArC;AACA,SAAKjB,kBAAL,CAAwBe,QAAxB,GAAmCuE,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,CAAnC;AACA,SAAKxF,kBAAL,CAAwBkB,MAAxB,GAAiCsB,MAAjC;AACA,SAAKxC,kBAAL,CAAwBmB,iBAAxB,GAA4CI,iBAA5C;AACA,QAAIkE,aAAa,GAAG,IAAIC,QAAJ,EAApB;;AACA,QAAI,KAAKC,aAAL,KAAuB9B,SAA3B,EAAsC;AAClC4B,MAAAA,aAAa,CAACG,MAAd,CAAqB,gCAArB,EAAuD,KAAKD,aAA5D,EAA2E,CAACR,EAAE,GAAG,KAAKQ,aAAX,MAA8B,IAA9B,IAAsCR,EAAE,KAAK,KAAK,CAAlD,GAAsD,KAAK,CAA3D,GAA+DA,EAAE,CAACrB,IAA7I;AACH;;AACD+B,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBL,aAAxB;AACA,UAAMM,qBAAqB,GAAG,KAAKzG,cAAL,CAAoB0G,aAApB,CAAkC,KAAK5E,SAAvC,EAAkD,KAAKpB,kBAAvD,CAA9B;AACA,UAAMiG,mBAAmB,GAAG,KAAK3G,cAAL,CAAoB4G,aAApB,CAAkC,KAAK9E,SAAvC,EAAkDqE,aAAlD,CAA5B;;AACA,QAAI,KAAKrE,SAAL,IAAkB,KAAKA,SAAL,KAAmB,EAAzC,EAA6C;AACzC;AACA,UAAI,KAAKpB,kBAAL,CAAwBmB,iBAAxB,IAA6C,KAAKnB,kBAAL,CAAwBmB,iBAAxB,KAA8C,EAA3F,IAAiG,KAAKnB,kBAAL,CAAwBmB,iBAAxB,KAA8C0C,SAAnJ,EAA8J;AAC1J1E,QAAAA,QAAQ,CAAC,CAAC4G,qBAAD,EAAwBE,mBAAxB,CAAD,CAAR,CAAuDrD,SAAvD,CAAiE;AAC7DuD,UAAAA,IAAI,EAAGC,IAAI,IAAI;AACX,iBAAK7G,MAAL,CAAY6D,QAAZ,CAAqB,CAAC,UAAD,CAArB;AACH,WAH4D;AAI7DiD,UAAAA,KAAK,EAAIA,KAAD,IAAW;AACfC,YAAAA,KAAK,CAACD,KAAK,CAACE,KAAP,CAAL;AACH;AAN4D,SAAjE;AAQH,OATD,MAUK;AACDD,QAAAA,KAAK,CAAC,OAAD,CAAL;AACH;AACJ,KAfD,MAgBK;AACD;AACA,UAAI,KAAKtG,kBAAL,CAAwBmB,iBAAxB,IAA6C,KAAKnB,kBAAL,CAAwBmB,iBAAxB,KAA8C,EAA3F,IAAiG,KAAKnB,kBAAL,CAAwBmB,iBAAxB,KAA8C0C,SAAnJ,EAA8J;AAC1J,aAAKvE,cAAL,CAAoBkH,UAApB,CAA+B,KAAKxG,kBAApC,EAAwD4C,SAAxD,CAAkE;AAC9DuD,UAAAA,IAAI,EAAGC,IAAI,IAAI;AACX;AACA,iBAAKK,GAAL;AACH,WAJ6D;AAK9DJ,UAAAA,KAAK,EAAIA,KAAD,IAAW;AACfC,YAAAA,KAAK,CAACD,KAAK,CAACE,KAAP,CAAL;AACH;AAP6D,SAAlE;AASH,OAVD,MAWK;AACDD,QAAAA,KAAK,CAAC,OAAD,CAAL;AACH;AACJ;AACJ;;AACKG,EAAAA,GAAG,GAAG;AAAA;;AAAA;AACR;AACA,YAAM,KAAI,CAACC,MAAL,EAAN;AAFQ;AAGX,GA3KqD,CA4KtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAA,EAAAA,MAAM,GAAG;AACL,QAAI,KAAKlD,YAAT,EAAuB;AACnB,YAAMmD,SAAS,GAAG,IAAIjB,QAAJ,EAAlB;AACAiB,MAAAA,SAAS,CAACf,MAAV,CAAiB,WAAjB,EAA8B,KAAKpC,YAAnC;AACA,WAAKlE,cAAL,CAAoB4G,aAApB,CAAkC,KAAK9E,SAAvC,EAAkDuF,SAAlD,EAA6D/D,SAA7D,CAAwEgE,QAAD,IAAc;AACjFf,QAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EADiF,CAEjF;AACH,OAHD,EAGIO,KAAD,IAAW;AACVR,QAAAA,OAAO,CAACQ,KAAR,CAAc,uBAAd,EAAuCA,KAAvC,EADU,CAEV;AACH,OAND;AAOH,KAVD,MAWK;AACDR,MAAAA,OAAO,CAACQ,KAAR,CAAc,mBAAd;AACH;AACJ;;AArMqD,CAA1D;AAuMAjH,sBAAsB,GAAGH,UAAU,CAAC,CAChCC,SAAS,CAAC;AACN2H,EAAAA,QAAQ,EAAE,oBADJ;AAENC,EAAAA,WAAW,EAAE,iCAFP;AAGNC,EAAAA,SAAS,EAAE,CAAC,gCAAD;AAHL,CAAD,CADuB,CAAD,EAMhC3H,sBANgC,CAAnC;AAOA,SAASA,sBAAT","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component } from '@angular/core';\r\nimport { forkJoin } from 'rxjs';\r\nlet ProductDetailComponent = class ProductDetailComponent {\r\n    constructor(productService, router, formBuilder, http, activeRoute) {\r\n        this.productService = productService;\r\n        this.router = router;\r\n        this.formBuilder = formBuilder;\r\n        this.http = http;\r\n        this.activeRoute = activeRoute;\r\n        this.editorConfig = {\r\n            base_url: '/tinymce',\r\n            suffix: '.min',\r\n            plugins: 'lists link image table wordcount'\r\n        };\r\n        this.productCategories = [];\r\n        this.postProductRequest = {\r\n            ProductID: \"\",\r\n            Thumb: \"\",\r\n            Title: \"\",\r\n            Avatar: \"\",\r\n            Description: \"\",\r\n            Content: \"\",\r\n            Specification: \"\",\r\n            Warranty: \"\",\r\n            Accessories: \"\",\r\n            Price: \"\",\r\n            OldPrice: \"\",\r\n            Quantity: \"\",\r\n            ImageList: \"\",\r\n            Position: \"\",\r\n            CreateBy: \"\",\r\n            CreateTime: new Date(),\r\n            Status: true,\r\n            ProductCategoryID: \"\"\r\n        };\r\n        this.productID = '';\r\n        this.form = this.formBuilder.group({\r\n            productCategoryID: [''],\r\n            username: [''],\r\n            title: [''],\r\n            thumb: [''],\r\n            avatar: [''],\r\n            description: [''],\r\n            content: [''],\r\n            specification: [''],\r\n            warranty: [''],\r\n            accessories: [''],\r\n            price: [''],\r\n            oldPrice: [''],\r\n            quantity: [''],\r\n            createTime: [''],\r\n            createBy: [''],\r\n            imageList: [''],\r\n            position: [''],\r\n            status: [true]\r\n        });\r\n    }\r\n    ngOnInit() {\r\n        const productsObservable = this.productService.getProductCategories();\r\n        productsObservable.subscribe((productsData) => {\r\n            this.productCategories = productsData;\r\n            this.activeRoute.queryParams.subscribe(params => {\r\n                this.productID = params.productID;\r\n                if (this.productID && this.productID !== \"\") {\r\n                    const productsObservable = this.productService.getProduct(this.productID);\r\n                    productsObservable.subscribe((productsData) => {\r\n                        this.postProductRequest = productsData;\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    }\r\n    backToList(e) {\r\n        e.preventDefault();\r\n        this.router.navigate(['/product']);\r\n    }\r\n    saveProduct(e) {\r\n        e.preventDefault();\r\n        this.router.navigate(['/product']);\r\n    }\r\n    onFileSelected(event) {\r\n        this.selectedFile = event.target.files[0];\r\n    }\r\n    showImg(imgName) {\r\n        //var str = \"FileUploads/Product/Avatar/f0f34b03-9f95-4efe-946a-39eb0d467af2.jpg\"\r\n        if (imgName !== undefined) {\r\n            var name = imgName.split('/')[4];\r\n            var imgUrl = 'https://localhost:7265/api/product/' + name;\r\n            return imgUrl;\r\n        }\r\n        return;\r\n    }\r\n    submitForm() {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;\r\n        debugger;\r\n        var productCategoryID = (_a = this.form.get('productCategoryID')) === null || _a === void 0 ? void 0 : _a.value;\r\n        var title = (_b = this.form.get('title')) === null || _b === void 0 ? void 0 : _b.value;\r\n        var avatar = (_c = this.form.get('avatar')) === null || _c === void 0 ? void 0 : _c.value;\r\n        var productID = (_d = this.form.get('productID')) === null || _d === void 0 ? void 0 : _d.value;\r\n        var thumb = (_e = this.form.get('thumb')) === null || _e === void 0 ? void 0 : _e.value;\r\n        var description = (_f = this.form.get('description')) === null || _f === void 0 ? void 0 : _f.value;\r\n        var specification = (_g = this.form.get('specification')) === null || _g === void 0 ? void 0 : _g.value;\r\n        var content = (_h = this.form.get('content')) === null || _h === void 0 ? void 0 : _h.value;\r\n        var warranty = (_j = this.form.get('warranty')) === null || _j === void 0 ? void 0 : _j.value;\r\n        var price = (_k = this.form.get('price')) === null || _k === void 0 ? void 0 : _k.value;\r\n        var oldPrice = (_l = this.form.get('oldPrice')) === null || _l === void 0 ? void 0 : _l.value;\r\n        var quantity = (_m = this.form.get('quantity')) === null || _m === void 0 ? void 0 : _m.value;\r\n        var imageList = (_o = this.form.get('imageList')) === null || _o === void 0 ? void 0 : _o.value;\r\n        var position = (_p = this.form.get('position')) === null || _p === void 0 ? void 0 : _p.value;\r\n        var createTime = (_q = this.form.get('createTime')) === null || _q === void 0 ? void 0 : _q.value;\r\n        var createBy = (_r = this.form.get('createBy')) === null || _r === void 0 ? void 0 : _r.value;\r\n        var status = (_s = this.form.get('status')) === null || _s === void 0 ? void 0 : _s.value;\r\n        this.postProductRequest.Title = title;\r\n        this.postProductRequest.ProductID = productID;\r\n        this.postProductRequest.Thumb = thumb;\r\n        this.postProductRequest.Description = description;\r\n        this.postProductRequest.Avatar = avatar;\r\n        this.postProductRequest.Specification = specification;\r\n        this.postProductRequest.Content = content;\r\n        this.postProductRequest.Warranty = warranty;\r\n        this.postProductRequest.Price = price;\r\n        this.postProductRequest.OldPrice = oldPrice;\r\n        this.postProductRequest.Quantity = quantity;\r\n        this.postProductRequest.ImageList = imageList;\r\n        this.postProductRequest.Position = position;\r\n        this.postProductRequest.CreateTime = new Date();\r\n        this.postProductRequest.CreateBy = window.localStorage.getItem('Username');\r\n        this.postProductRequest.Status = status;\r\n        this.postProductRequest.ProductCategoryID = productCategoryID;\r\n        let imageFormData = new FormData();\r\n        if (this.uploadedImage !== undefined) {\r\n            imageFormData.append('this.postProductRequest.Avatar', this.uploadedImage, (_t = this.uploadedImage) === null || _t === void 0 ? void 0 : _t.name);\r\n        }\r\n        console.log(\"formdata\", imageFormData);\r\n        const updateProductforkJoin = this.productService.updateProduct(this.productID, this.postProductRequest);\r\n        const upLoadImageforkJoin = this.productService.uploadImagev2(this.productID, imageFormData);\r\n        if (this.productID && this.productID !== \"\") {\r\n            //Update\r\n            if (this.postProductRequest.ProductCategoryID && this.postProductRequest.ProductCategoryID !== \"\" && this.postProductRequest.ProductCategoryID !== undefined) {\r\n                forkJoin([updateProductforkJoin, upLoadImageforkJoin]).subscribe({\r\n                    next: (data => {\r\n                        this.router.navigate(['/product']);\r\n                    }),\r\n                    error: ((error) => {\r\n                        alert(error.Error);\r\n                    })\r\n                });\r\n            }\r\n            else {\r\n                alert('error');\r\n            }\r\n        }\r\n        else {\r\n            //Add new\r\n            if (this.postProductRequest.ProductCategoryID && this.postProductRequest.ProductCategoryID !== \"\" && this.postProductRequest.ProductCategoryID !== undefined) {\r\n                this.productService.addProduct(this.postProductRequest).subscribe({\r\n                    next: (data => {\r\n                        // this.router.navigate(['/product']);\r\n                        this.add();\r\n                    }),\r\n                    error: ((error) => {\r\n                        alert(error.Error);\r\n                    })\r\n                });\r\n            }\r\n            else {\r\n                alert('error');\r\n            }\r\n        }\r\n    }\r\n    async add() {\r\n        // await this.addItem();\r\n        await this.addImg();\r\n    }\r\n    // addItem() {\r\n    //   this.productService.addProduct(this.postProductRequest).subscribe({\r\n    //     next: (data => {\r\n    //       // this.router.navigate(['/product']);\r\n    //     }),\r\n    //     error: ((error: ErrorResponse) => {\r\n    //       alert(error.Error);\r\n    //     })\r\n    //   });\r\n    // }\r\n    addImg() {\r\n        if (this.selectedFile) {\r\n            const imageFile = new FormData();\r\n            imageFile.append('imageFile', this.selectedFile);\r\n            this.productService.uploadImagev2(this.productID, imageFile).subscribe((response) => {\r\n                console.log('File uploaded successfully');\r\n                // Xử lý dữ liệu phản hồi từ API nếu cần\r\n            }, (error) => {\r\n                console.error('Error uploading file:', error);\r\n                // Xử lý lỗi nếu cần\r\n            });\r\n        }\r\n        else {\r\n            console.error('No file selected.');\r\n        }\r\n    }\r\n};\r\nProductDetailComponent = __decorate([\r\n    Component({\r\n        selector: 'app-product-detail',\r\n        templateUrl: './product-detail.component.html',\r\n        styleUrls: ['./product-detail.component.css']\r\n    })\r\n], ProductDetailComponent);\r\nexport { ProductDetailComponent };\r\n"]},"metadata":{},"sourceType":"module"}